---
driver:
  name: docker

provisioner:
  name: chef_zero

verifier:
  name: inspec

platforms:
  - name: ubuntu-20.04

suites:
  - name: default
    run_list:
      - recipe[my_cookbook::search_head]
    attributes:
      container_ip_base: "172.18.0."
      container_ip_start: 2

driver_config:
  network_mode: custom_network
  use_sudo: false

# Network definition
driver:
  name: docker
  privileged: true
  network:
    name: custom_network
    driver: bridge

suites:
  #  - name: deployer
  # run_list:
  #   - recipe[cerner_splunk::search_head]
  #   - recipe[cerner_splunk::init_cluster]
  # driver_config:
  #   forward:
  #     - "8003:8000"
  #     - "8090:8089"
  #     - "34567:34567"
  #   network_mode: custom_network
  #   docker_options:
  #     - "--ip=172.18.0.5"
  # data_bags_path: "/root/data_bags"
  # - name: container1
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::init_cluster]
  #   driver_config:
  #     forward:
  #       - "8000:8000"
  #       - "8091:8089"
  #       - "34568:34567"
  #     network_mode: custom_network
  #     docker_options:
  #       - "--ip=172.18.0.2"
  #   data_bags_path: "/root/data_bags"
  # - name: container2
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::init_cluster]
  #   driver_config:
  #     forward:
  #       - "8001:8000"
  #       - "8092:8089"
  #       - "34569:34567"
  #     network_mode: custom_network
  #     docker_options:
  #       - "--ip=172.18.0.3"
  #   data_bags_path: "/root/data_bags"
  # - name: container3
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::init_cluster]
  #     - recipe[cerner_splunk::captain-bootstrap]
  #   driver_config:
  #     forward:
  #       - "8002:8000"
  #       - "8093:8089"
  #       - "34570:34567"
  #     network_mode: custom_network
  #     docker_options:
  #       - "--ip=172.18.0.4"
  #   data_bags_path: "/root/data_bags"
  - name: indexer-master
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::indexer-cluster]
    driver_config:
      forward:
        - "8003:8000"
        - "9000:9000"
        - "8089:8089"
      network_mode: custom_network
      docker_options:
        - "--ip=172.18.0.5"
        - "--expose=8089"
        - "--expose=9000"
    data_bags_path: "/root/data_bags"
  - name: indexer-node1
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::indexer-cluster]
    driver_config:
      forward:
        - "8004:8000"
        - "9001:9000"
        - "8090:8089"
      network_mode: custom_network
      docker_options:
        - "--ip=172.18.0.6"
        - "--expose=8089"
        - "--expose=9000"
    data_bags_path: "/root/data_bags"
  - name: indexer-node2
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::indexer-cluster]
    driver_config:
      forward:
        - "8005:8000"
        - "9002:9000"
        - "8091:8089"
      network_mode: custom_network
      docker_options:
        - "--ip=172.18.0.7"
        - "--expose=8089"
        - "--expose=9000"
    data_bags_path: "/root/data_bags"
  - name: indexer-node3
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::indexer-cluster]
    driver_config:
      forward:
        - "8006:8000"
        - "9003:9000"
        - "8092:8089"
      network_mode: custom_network
      docker_options:
        - "--ip=172.18.0.8"
        - "--expose=8089"
        - "--expose=9000"
    data_bags_path: "/root/data_bags"

