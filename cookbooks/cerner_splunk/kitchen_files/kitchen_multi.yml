---
driver:
  name: docker

provisioner:
  name: chef_zero

verifier:
  name: inspec

platforms:
  - name: ubuntu-20.04

driver_config:
  use_sudo: false
  # Network definition
  networks:
    - name: custom_network
      driver: bridge

suites:
  - name: default
    run_list:
      - recipe[cerner_splunk::search_head]
    attributes:
      container_ip_base: "172.18.0."
      container_ip_start: 2


  - name: indexer-master-1
    driver:
      hostname: multi_master
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::_configure_server]
    driver_config:
      network_mode: custom_network
      forward:
        - "8003:8000"
        - "9000:9000"
        - "8089:8089"
      docker_options:
        - "--ip=172.18.0.5"
        - "--expose=8089"
        - "--expose=9000"

  - name: indexer-node1-site1
    driver:
      hostname: indexer-1node-site1
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::_configure_server]
    driver_config:
      network_mode: custom_network
      forward:
        - "8004:8000"
        - "9001:9000"
        - "8090:8089"
      docker_options:
        - "--ip=172.18.0.6"
        - "--expose=8089"
        - "--expose=9000"

  # - name: indexer-node2-site1
  #   driver:
  #     hostname: indexer-2node-site1
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::_configure_server]
  #   driver_config:
  #     network_mode: custom_network
  #     forward:
  #       - "8005:8000"
  #       - "9002:9000"
  #       - "8091:8089"
  #     docker_options:
  #       - "--ip=172.18.0.7"
  #       - "--expose=8089"
  #       - "--expose=9000"


  # - name: indexer-node3-site1
  #   driver:
  #     hostname: indexer-3node-site1
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::_configure_server]
  #   driver_config:
  #     network_mode: custom_network
  #     forward:
  #       - "8006:8000"
  #       - "9003:9000"
  #       - "8092:8089"
  #     docker_options:
  #       - "--ip=172.18.0.7"
  #       - "--expose=8089"
  #       - "--expose=9000"

  - name: indexer-node1-site2
    driver:
      hostname: indexer-1node-site2
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::_configure_server]
    driver_config:
      network_mode: custom_network
      forward:
        - "8007:8000"
        - "9004:9000"
        - "8093:8089"
      docker_options:
        - "--ip=172.18.0.7"
        - "--expose=8089"
        - "--expose=9000"

  # - name: indexer-node2-site2
  #   driver:
  #     hostname: indexer-1node-site2
  #   run_list:
  #     - recipe[cerner_splunk::search_head]
  #     - recipe[cerner_splunk::_configure_server]
  #   driver_config:
  #     network_mode: custom_network
  #     forward:
  #       - "8008:8000"
  #       - "9005:9000"
  #       - "8094:8089"
  #     docker_options:
  #       - "--ip=172.18.0.7"
  #       - "--expose=8089"
  #       - "--expose=9000"
 

  - name: indexer-searchhead-site1
    driver:
      hostname: searchhead-site1
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::_configure_server]
    driver_config:
      network_mode: custom_network
      forward:
        - "8009:8000"
        - "9006:9000"
        - "8095:8089"
      docker_options:
        - "--ip=172.18.0.9"
        - "--expose=8089"
        - "--expose=9000"

  - name: indexer-searchhead-site2
    driver:
      hostname: searchhead-site2
    run_list:
      - recipe[cerner_splunk::search_head]
      - recipe[cerner_splunk::_configure_server]
    driver_config:
      network_mode: custom_network
      forward:
        - "8010:8000"
        - "9007:9000"
        - "8096:8089"
      docker_options:
        - "--ip=172.18.0.8"
        - "--expose=8089"
        - "--expose=9000"


